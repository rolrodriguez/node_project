<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form action="./getPerson/">
        <label for="inputId">ID:</label>
        <input type="number" id="inputId" name="inputId" />
        <input type="button" id="inputSearch" value="Search"/>
        <input type="button" id="inputParent" value="Parent"/>
        <input type="button" id="inputChildren" value="Children"/>
    </form>
    <div id="result">
        
    </div>
    <div id="resultParent"></div>
    <div id="resultChildren"></div>
<script>
    let button = document.querySelector('#inputSearch');
    let buttonParent = document.querySelector('#inputParent');
    let buttonChildren = document.querySelector('#inputChildren');
    let inputID = document.querySelector('#inputId');
    let result = document.querySelector('#result');
    let resultParent = document.querySelector('#resultParent');
    let resultChildren = document.querySelector('#resultChildren');

    async function getPerson(endpoint, id, resultElem){
        try {
            let resp = await fetch(endpoint+id);
            if(resp.status == 404){
            resultElem.innerHTML = "";
            }
            else{
                let json = await resp.json();
                resultElem.innerHTML = JSON.stringify(json, 4);
            }   
        } catch (error) {
            console.error(error);
        }
    }

    button.onclick = async (e) =>{
        e.preventDefault();
        getPerson('getPerson/', inputID.value, result);

    }
    buttonParent.onclick = async (e) =>{
        e.preventDefault();
        try {
            let resp = await fetch(`getParents/${inputID.value}`);
            if(resp.status == 404){
            resultParent.innerHTML = "";
            }
            else{
                let json = await resp.json();
                let parent = json['parent'];
                getPerson('getPerson/', parent, resultParent);
            }   
        } catch (error) {
            console.error(error);
        }

    }
    buttonChildren.onclick = async (e) =>{
        e.preventDefault();
        try {
            let resp = await fetch(`getChildren/${inputID.value}`);
            if(resp.status == 404){
            resultChildren.innerHTML = "";
            }
            else{
                let json = await resp.json();
                let children = json['children'];
                getPerson('getPerson/', children, resultChildren);
            }   
        } catch (error) {
            console.error(error);
        }

    }
</script>
</body>
</html>